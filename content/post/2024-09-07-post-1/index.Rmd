---
title: Blog Post 1
author: Rachael Dziaba
date: '2024-09-07'
slug: post-1
categories:
  - blog
tags: []
draft: false
---
In my first blog post of the series, I will be analyzing and visualizing two foundational questions about the election: 
   1. How competitive are presidential elections in the United States?
   2. Which states vote blue/red and how consistently?

I also will be customizing my visualizations (extension #1). See citations for data, code, and other sources at the bottom.
---
```{r plot1, echo=FALSE}
library(ggplot2)
library(maps)
library(tidyverse)

d_popvote <- read_csv("popvote_1948-2020.csv")
d_popvote %>% 
  filter(year == 2020) %>% 
  select(party, candidate, pv2p)
(d_popvote_wide <- d_popvote %>%
    select(year, party, pv2p) %>%
    pivot_wider(names_from = party, values_from = pv2p))
(d_popvote_wide <- d_popvote_wide %>% 
    mutate(winner = case_when(democrat > republican ~ "D",
                              TRUE ~ "R")))
d_popvote_wide %>%
  group_by(winner) %>%
  summarise(races = n())
  
my_custom_theme <- theme_bw() + 
  theme(panel.border = element_blank(),
        plot.title = element_text(family = "Georgia", size = 15, face = "bold", hjust = 0.5),
        axis.text = element_text(family = "Georgia", size = 12),
        axis.line = element_line(colour = "black"),
        legend.position = "bottom",
        legend.title = element_text(family = "Georgia", size = 12),
        legend.text = element_text(family = "Georgia", size = 12),
        legend.box.background = element_rect(color = "black", size = 0.5), 
        axis.title.x = element_text(family = "Georgia", size = 13),
        axis.title.y = element_text(family = "Georgia", size = 13))

d_popvote %>%
  ggplot(aes(x = year, y = pv2p, color = party)) + 
  geom_line() +
  geom_point(size = 2) +
  scale_color_manual(values = c("royalblue3", "red3"), labels = c("Democrat", "Republican")) +
  ggtitle("Presidential Vote Share by Party") +
  labs(x = "Year", y = "Popular Vote Percentage", color = "Party:") +
  my_custom_theme

```
---
```{r plot2, echo=FALSE, eval=FALSE}
states_map <- map_data("state")
d_pvstate_wide <- read_csv("clean_wide_state_2pv_1948_2020.csv")
`d_pvstate_wide$region <- tolower(d_pvstate_wide$state)
pv_map <- d_pvstate_wide %>%
  filter(year == 2020) %>%
  left_join(states_map, by = "region")`
pv_win_map <- d_pvstate_wide %>%
  filter(year == 2020) %>%
  left_join(states_map, by = "region") %>%
  mutate(winner = ifelse(R_pv > D_pv, "republican", "democrat"))
pv_win_map %>%
  ggplot(aes(long, lat, group = group)) +
  geom_polygon(aes(fill = winner), color = "black") +
  scale_fill_manual(values = c("dodgerblue4", "firebrick1"))